ProxyLogon漏洞 攻擊事件

事件說明：

曾多次在世界駭客大會（DEFCON）進行專題演講獲肯定，台灣資安廠DEVCORE戴夫寇爾首席資安研究員蔡政達（Orange Tsai），今年3月初因挖出微軟郵件伺服器軟體Exchange零日漏洞，獲微軟公開致謝，不過DEVCORE概念性攻擊程式（PoC Exploit）隨即成為中國駭客攻擊全球工具，資深國際資安顧問李先生表示，以其專業白帽駭客背景，應不至犯下這種錯誤。

在高二時代就開始對於資安漏洞挖掘產生興趣，當初覺得當駭客很酷，也回報過各大社群平台知名漏洞，Orange表示，因找漏洞很有趣而投入資安工作，對於能夠找黑帽（壞）駭客利用漏洞搞破壞前就能回報阻止，協助維護全球資安（拯救世界）感到很有成就感。「每天除睡覺外，都在電腦前挖洞（找漏洞）」，Orange說，DEVCORE的紅隊（敵軍）攻防演練成員們，可利用研究團隊的發現和成果強化「駭客思維」，更能真實模擬客戶可能遇到的攻擊情境。

在2019年帶領DEVCORE團隊，代表台灣首度拿下駭客界奧斯卡「Pwnie Awards」獎中的「年度最佳伺服器漏洞」（Pwnie for Best Server-Side Bug）獎項，為何對於微軟Exchange Server漏洞產生興趣？Orange表示，Microsoft Exchange是全球使用者人數眾多的電子郵件系統之一，若遭受真正的駭客攻擊，恐造成企業機敏資料外洩並導致極大損失。團隊過去也研究包含Exim及Dovecot等郵件軟體的豐富經驗，所以決定先研究企業常用的Microsoft Exchange，盼強化全球資安意識，預防可能發生的攻擊與損失。

Orange表示，DEVCORE研究團隊，從2020年10月開始，花了2個多月研究，在2020年12月10日發現第一個的漏洞CVE-2021-26855，「第一個的漏洞CVE-2021-26855，是伺服器端請求偽造（SSRF）漏洞，在2013年的Exchange版本就有了，我們評估是中度風險的漏洞」，由於該漏洞在 Microsoft Exchange 處理流程中，仍屬非常前期階段，Orange也好奇為什麼沒有其他研究單位發現此漏洞，一度擔心回報後恐避不了撞洞（與別人回報的漏洞相同，猶如穿相同衣服「撞衫」）。

之後團隊在2020年12月30日發現第二個漏洞CVE-2021-27065，並在12月31日將兩個漏洞串聯，組成一個漏洞PoC Exploit（概念驗證攻擊程式），可直接進入企業內網。並命名為ProxyLogon重大「無需驗證的遠端程式碼執行（Pre-Auth Remote Code Execution； Pre-Auth RCE）零日漏洞，最重要的是，光是寫出來的概念驗證攻擊程序（Zero-day PoC exploit），就可讓攻擊者不用帳號密碼就可在受駭伺服器直接使用管理員身分，執行任何惡意文件或指令，進而觸發更廣泛的攻擊。

Orange強調，「這是駭客最想要得到的權限」，ProxyLogon 也是微軟近期被揭露最重大的 RCE 漏洞之一，但與經常被媒體報導的有些駭客會因此到處炫耀作法不同，DEVCORE遵循駭客責任揭露（Responsible Disclosure）原則， 並於2021年1月5日第一時間通報微軟進行相關修補，以免該漏洞遭有心人士利用，造成全球用戶重大損失。之後也在1月8日獲微軟回信認證該回報有效並開始處理。

Orange說，自己過去並不太對微軟產品有興趣，高中後十餘年沒碰過，去年才開始再研究，漏洞挖掘一開始是在二進位（binary） 上記憶體類型的漏洞（memory corruption ）著手，遲遲沒有斬獲，接著才開始用自己最熟悉的尋找網頁類型（web） 漏洞切入。

「因為當初交付給微軟的RCE漏洞，是透過一鍵即可擊發的Exploit PoC概念攻擊程序展示Orange坦言，自己直覺是使用最熟悉常用的網路代碼「Orange」當密碼，直接在微軟安全回應中心系統回報，也心想應該不會有第三者會看到，所以沒特別設限。沒想到在2月下旬出現的大批Exchange伺服器零時差攻擊，「Orange」居然出現在駭客惡意攻擊封包中，儘管DEVCORE在3月2日立即進行內部徹底清查，但並無外洩跡象，Orange說道，「被誤解確實很無奈，希望能儘速找出外洩執行源碼的缺口」。
來源：自由財經 https://ec.ltn.com.tw/article/breakingnews/3473082

若是遭受了這種駭客的攻擊，不只個人資料會外洩，信用卡卡號也可能會被駭客竊取，甚至電腦還可能被植入勒索軟體，使得重要的檔案無法取回。
於是我在網路上搜尋了一些，防範這種攻擊的方法。

對付Exchange Server零時差漏洞攻擊的四招防範：


1.找到所有Exchange Server，確定是否需要修補漏洞
2. 修補並保護企業所有的Exchange Server
3. 確定Exchange Server是否已經受到威脅
4.如果遭受到攻擊，請與資安事件應變小組聯繫

以上4點詳細內容可至https://blog.paloaltonetworks.com/2021/03/exchange-server-4-remediation/?lang=zh-hant (Palo Alto Networks提出)
